import{o as h,c as S,d as P,s as _,m as A,b4 as q,a as c,f as L,b7 as M,b9 as G,e as I,w as y,l as g,a$ as z,g as a,b8 as B,a_ as V,h as O,bC as X,i as $,b as H,k as W,aI as J,t as U,a1 as k,F,G as N,ag as Q,ah as R,q as Z,be as x,bf as ee,bg as te,a2 as ae,aK as E,bj as oe}from"./I0J7D7wH.js";import{a as j,i as se}from"./C2wCgOwX.js";import{_ as le,U as D,b as ie,c as T}from"./DOvt5s4i.js";import{a as ne}from"./Bf6kWBt7.js";import{t as re}from"./Ckh0oh2P.js";const ue={},ce={class:"tw-bg-primary-600 tw-w-1500 tw-h-1500 tw-rounded-full"};function me(n,o){return h(),S("div",ce)}const de=le(ue,[["render",me]]),pe=1*1e3*1e3,fe=["multiple","accept"],he=P({__name:"DeFileUpload",props:{accept:{default:"image/*"},maxFileSize:{default:5*pe},multiple:{type:Boolean},fileLimit:{}},emits:["select"],setup(n,{emit:o}){const r=n,m=o,s=_(null);function t(){var d;(d=s.value)==null||d.click()}function e(){s.value&&(s.value.value="")}const{t:u}=A(),b=q();function w(d){return!(r.maxFileSize&&d.size>r.maxFileSize)}const p=re(),i=Intl.NumberFormat(p,{notation:"compact",style:"unit",unit:"byte",unitDisplay:"narrow"});function l(d){const C=Array.from(d.target.files);if(r.fileLimit&&C.length>r.fileLimit){M(b,{body:u("errors.invalidFileLimit",{limit:r.fileLimit}),iconName:"attention"}),e();return}for(const f of C)w(f)?m("select",f):M(b,{body:u("errors.invalidFileSize",{size:i.format(r.maxFileSize)}),iconName:"attention"});e()}return(d,C)=>(h(),S("div",null,[c("input",{ref_key:"input",ref:s,type:"file",hidden:"",multiple:d.multiple,accept:d.accept,onChange:l},null,40,fe),L(d.$slots,"header",{chooseCallback:t})]))}}),ge=".jpg, .png, .jpeg",be=P({__name:"UploadButton",props:{showChooseIcon:{type:Boolean,default:!0},chooseIcon:{default:"upload-cloud"},chooseLabelKey:{default:"common.buttons.upload"},accept:{default:ge},buttonCategory:{default:G.primary},multiple:{type:Boolean},fileLimit:{}},emits:["change"],setup(n,{emit:o}){const{t:r}=A(),m=o,s=t=>{m("change",t)};return(t,e)=>(h(),I(he,{"choose-icon":t.chooseIcon,accept:t.accept,multiple:t.multiple,"file-limit":t.fileLimit,onSelect:s},{header:y(({chooseCallback:u})=>[L(t.$slots,"header",{scope:{chooseCallback:u}},()=>[g(z,{variant:a(B).confirm,category:t.buttonCategory,size:a(V).medium,icon:t.showChooseIcon?t.chooseIcon:void 0,"icon-class":t.showChooseIcon?"tw-w-3 tw-h-3 tw-mr-2":void 0,label:a(r)(t.chooseLabelKey),class:"tw-w-full",onClick:u},null,8,["variant","category","size","icon","icon-class","label","onClick"])])]),_:3},8,["choose-icon","accept","multiple","file-limit"]))}}),we=["src"],ve=["src"],_e={class:"body-b1"},ye=P({__name:"UploadImageWithButton",props:{imageUrl:{},imageClass:{default:"tw-h-2000 tw-w-2000"},imageWrapClass:{},uploadBtnClass:{},type:{default:"circle"},isLoading:{type:Boolean},fallbackImg:{},accept:{},hintMessage:{},buttonCategory:{},chooseLabelKey:{},showChooseIcon:{type:Boolean,default:!0}},emits:["change"],setup(n,{emit:o}){const r=n,m=o,s=O(()=>r.fallbackImg||X);function t(e){m("change",e)}return(e,u)=>(h(),S("div",{class:$(["upload-image-with-button",`upload-image-with-button-${e.type}`])},[c("div",{class:$(["upload-image-with-button-image-wrap",e.imageWrapClass])},[e.imageUrl?(h(),S("img",{key:0,class:$(["upload-image-with-button-image",e.imageClass]),src:e.imageUrl},null,10,we)):H("",!0),W(c("img",{class:$(["upload-image-with-button-image",e.imageClass]),src:s.value},null,10,ve),[[J,s.value&&!e.imageUrl]])],2),g(be,{accept:e.accept,"button-category":e.buttonCategory,"choose-label-key":e.chooseLabelKey,"show-choose-icon":e.showChooseIcon,class:$(e.uploadBtnClass),onChange:t},null,8,["accept","button-category","choose-label-key","show-choose-icon","class"]),L(e.$slots,"hint",{},()=>[c("p",_e,U(e.hintMessage),1)])],2))}}),Ue=()=>{const n=_([]);return{uploadFiles:m=>{m.forEach(s=>{const t=URL.createObjectURL(s),e=new FormData;e.append("profile_picture",s);const u={raw:e,imageUrl:t};n.value=[...n.value,u]})},uploadFilesEntities:n,deleteUploadedFile:m=>{n.value=n.value.filter((s,t)=>m!==t)}}},Se={class:"heading-h5 tw-mb-4"},Ce={class:"tw-list-disc tw-list-inside tw-mt-4.5 tw-mb-2 body-b1"},$e={class:"heading-h5"},Pe={class:"tw-flex tw-justify-between tw-gap-4 tw-mt-6"},Y=P({__name:"UserProfileAvatarUploader",props:{modelValue:{required:!0},modelModifiers:{},raw:{},rawModifiers:{}},emits:["update:modelValue","update:raw"],setup(n){const{t:o}=A(),r=[{id:"presetAvatar",title:o("user.settings.profile.completeProfile.presetAvatar")}],m=["user.settings.profile.completeProfile.hint.0","user.settings.profile.completeProfile.hint.1","user.settings.profile.completeProfile.hint.2"],s=k(n,"modelValue"),t=k(n,"raw"),{uploadFiles:e,deleteUploadedFile:u,uploadFilesEntities:b}=Ue();function w(p){var i,l;u(0),e([p]),s.value=(i=b.value[0])==null?void 0:i.imageUrl,t.value=(l=b.value[0])==null?void 0:l.raw}return(p,i)=>(h(),S(F,null,[c("h2",Se,U(a(o)("form.yourX",{field:"common.avatar"})),1),c("form",null,[g(ye,{"image-url":s.value,"fallback-img":a(Q),class:"tw-justify-between",onChange:w},{hint:y(()=>[c("ul",Ce,[(h(),S(F,null,N(m,(l,d)=>c("li",{key:d},[c("span",null,U(a(o)(l)),1)])),64))])]),_:1},8,["image-url","fallback-img"]),g(ne,{tabs:r,class:"tw-text-accent-500","header-icon-position":"end","header-icon-class":"!tw-text-accent-500"},{header:y(({item:l})=>[c("div",$e,U(l.title),1)]),content:y(()=>[c("ul",Pe,[(h(),S(F,null,N(7,l=>c("li",{key:l},[g(de)])),64))])]),_:1})])],64))}}),Ae={class:"body-b1 tw-text-primary-200 tw-whitespace-break-spaces tw-mt-4"},Fe=P({__name:"UserSettingsCustomizeAvatarDialog",props:{modelValue:{type:Boolean,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(n){const{t:o}=A(),{$customFetch:r}=R(),m=Z(),s=k(n,"modelValue"),t=_(m.user.profile.photo),e=_(null),u=_(!1),b=D(r);async function w(){if(u.value=!0,!!e.value)try{const p=await b.uploadUserPhoto(e.value);m.updateUserPhoto(p.path),s.value=!1}finally{u.value=!1}}return(p,i)=>(h(),I(j,{visible:s.value,"onUpdate:visible":i[2]||(i[2]=l=>s.value=l),class:"tw-w-[600px]"},{header:y(({props:l})=>[c("h2",{class:$(l.class)},U(a(o)("user.settings.profile.customizeYourAvatar.title")),3),c("p",Ae,U(a(o)("user.settings.profile.customizeYourAvatar.subtitle")),1)]),default:y(()=>[g(Y,{modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=l=>t.value=l),raw:e.value,"onUpdate:raw":i[1]||(i[1]=l=>e.value=l),loading:u.value},null,8,["modelValue","raw","loading"]),g(z,{type:"submit",variant:a(B).confirm,size:a(V).medium,label:p.$t("common.buttons.submit"),loading:u.value,disabled:!e.value,class:"tw-w-full tw-mt-10",onClick:w},null,8,["variant","size","label","loading","disabled"])]),_:1},8,["visible"]))}}),Ee=Object.freeze(Object.defineProperty({__proto__:null,default:Fe},Symbol.toStringTag,{value:"Module"})),ke={class:"heading-h2 tw-mb-4"},Le={class:"body-b1 tw-text-primary-200"},Ie=P({__name:"UserCompleteProfile",setup(n){const{t:o}=A(),{handleSubmit:r,errors:m,values:s,isSubmitting:t}=x({validationSchema:ee({name:te().required(o("form.enterYourX",{field:"form.displayName"}))})}),e=O(()=>!s.name||!se(m.value)),{$customFetch:u}=R(),{getUser:b}=ie(),w=_(null),p=_(""),i=_(null),l=D(u),d=r(async C=>{var v;const f=[l.updateUserName(C.name)];if(i.value){const K=l.uploadUserPhoto(i.value);f.push(K)}await Promise.allSettled(f),await b(),(v=w.value)==null||v.close()});return(C,f)=>(h(),I(j,{ref_key:"dialog",ref:w,class:"md:tw-w-[600px]"},{header:y(()=>[c("div",ke,U(a(o)("user.settings.profile.completeProfile.title")),1),c("p",Le,U(a(o)("user.settings.profile.completeProfile.subtitle")),1)]),default:y(()=>[c("form",{onSubmit:f[2]||(f[2]=ae((...v)=>a(d)&&a(d)(...v),["prevent"]))},[g(Y,{modelValue:a(p),"onUpdate:modelValue":f[0]||(f[0]=v=>E(p)?p.value=v:null),raw:a(i),"onUpdate:raw":f[1]||(f[1]=v=>E(i)?i.value=v:null)},null,8,["modelValue","raw"]),g(oe,{id:"name",placeholder:a(o)("form.chooseYourOwnNickname"),label:a(o)("form.displayName"),maxlength:a(T),"hint-message":a(o)("form.rules.maxXChars",{max:a(T)}),"show-word-limit":"",class:"tw-w-full"},null,8,["placeholder","label","maxlength","hint-message"]),g(z,{size:a(V).medium,variant:a(B).confirm,disabled:a(e),loading:a(t),type:"submit",label:a(o)("common.buttons.saveAndProceed"),class:"tw-w-full tw-mt-10"},null,8,["size","variant","disabled","loading","label"])],32)]),_:1},512))}}),Te=Object.freeze(Object.defineProperty({__proto__:null,default:Ie},Symbol.toStringTag,{value:"Module"}));export{Ee as U,Te as a};
